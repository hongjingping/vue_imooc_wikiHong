{"version":3,"sources":["../thenify/index.js"],"names":[],"mappings":";AACA,IAAI,UAAU,QAAQ,aAAR,CAAd;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;;AAEA,OAAO,OAAP,GAAiB,OAAjB;;AAEA;;;;;;;;AAQA,SAAS,OAAT,CAAiB,UAAjB,EAA6B,OAA7B,EAAsC;AACpC,SAAO,OAAO,UAAP,KAAsB,UAA7B;AACA,SAAO,KAAK,cAAc,WAAW,IAAzB,EAA+B,OAA/B,CAAL,CAAP;AACD;;AAED;;;;;;;;AAQA,QAAQ,YAAR,GAAuB,UAAU,UAAV,EAAsB,OAAtB,EAA+B;AACpD,SAAO,OAAO,UAAP,KAAsB,UAA7B;AACA,YAAU,WAAW,EAArB;AACA,UAAQ,YAAR,GAAuB,IAAvB;AACA,MAAI,QAAQ,SAAR,KAAsB,SAA1B,EAAqC,QAAQ,SAAR,GAAoB,IAApB;AACrC,SAAO,KAAK,cAAc,WAAW,IAAzB,EAA+B,OAA/B,CAAL,CAAP;AACD,CAND;;AAQA,SAAS,cAAT,CAAwB,OAAxB,EAAiC,MAAjC,EAAyC,SAAzC,EAAoD;AAClD,SAAO,UAAS,GAAT,EAAc,KAAd,EAAqB;AAC1B,QAAI,GAAJ,EAAS,OAAO,OAAO,GAAP,CAAP;AACT,QAAI,SAAS,UAAU,MAAvB;;AAEA,QAAI,UAAU,CAAV,IAAe,CAAC,SAApB,EAA+B,OAAO,QAAQ,KAAR,CAAP;;AAE/B,QAAI,MAAM,OAAN,CAAc,SAAd,CAAJ,EAA8B;AAC5B,UAAI,SAAS,EAAb;AACA,WAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,MAApB,EAA4B,GAA5B,EAAiC,OAAO,UAAU,IAAI,CAAd,CAAP,IAA2B,UAAU,CAAV,CAA3B;AACjC,aAAO,QAAQ,MAAR,CAAP;AACD;;AAED,QAAI,SAAS,IAAI,KAAJ,CAAU,SAAS,CAAnB,CAAb;AACA,SAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,MAApB,EAA4B,EAAE,CAA9B,EAAiC,OAAO,IAAI,CAAX,IAAgB,UAAU,CAAV,CAAhB;AACjC,YAAQ,MAAR;AACD,GAfD;AAgBD;;AAED,SAAS,aAAT,CAAuB,IAAvB,EAA6B,OAA7B,EAAsC;AACpC,SAAO,CAAC,QAAQ,EAAT,EAAa,OAAb,CAAqB,gBAArB,EAAuC,EAAvC,CAAP;AACA,YAAU,WAAW,EAArB;AACA;AACA,MAAI,YAAY,QAAQ,SAAR,KAAsB,SAAtB,GAAkC,QAAQ,SAA1C,GAAsD,IAAtE;AACA,cAAY,qBAAqB,KAAK,SAAL,CAAe,SAAf,CAArB,GAAiD,IAA7D;;AAEA,MAAI,eAAe,QAAQ,YAAR,GACjB,+CACE,yEAFe,GAGhB,EAHH;;AAKA,SAAO,eAAe,IAAf,GAAsB,QAAtB,GACH,mBADG,GAEH,8BAFG,GAGH,SAHG,GAIH,YAJG,GAKH,iCALG,GAMH,wDANG,GAOH,qBAPG,GAQH,mDARG,GASD,gEATC,GAUD,gCAVC,GAWH,MAXG,GAYL,IAZF;AAaD","file":"index-compiled.js","sourcesContent":["\nvar Promise = require('any-promise')\nvar assert = require('assert')\n\nmodule.exports = thenify\n\n/**\n * Turn async functions into promises\n *\n * @param {Function} $$__fn__$$\n * @return {Function}\n * @api public\n */\n\nfunction thenify($$__fn__$$, options) {\n  assert(typeof $$__fn__$$ === 'function')\n  return eval(createWrapper($$__fn__$$.name, options))\n}\n\n/**\n * Turn async functions into promises and backward compatible with callback\n *\n * @param {Function} $$__fn__$$\n * @return {Function}\n * @api public\n */\n\nthenify.withCallback = function ($$__fn__$$, options) {\n  assert(typeof $$__fn__$$ === 'function')\n  options = options || {}\n  options.withCallback = true\n  if (options.multiArgs === undefined) options.multiArgs = true\n  return eval(createWrapper($$__fn__$$.name, options))\n}\n\nfunction createCallback(resolve, reject, multiArgs) {\n  return function(err, value) {\n    if (err) return reject(err)\n    var length = arguments.length\n\n    if (length <= 2 || !multiArgs) return resolve(value)\n\n    if (Array.isArray(multiArgs)) {\n      var values = {}\n      for (var i = 1; i < length; i++) values[multiArgs[i - 1]] = arguments[i]\n      return resolve(values)\n    }\n\n    var values = new Array(length - 1)\n    for (var i = 1; i < length; ++i) values[i - 1] = arguments[i]\n    resolve(values)\n  }\n}\n\nfunction createWrapper(name, options) {\n  name = (name || '').replace(/\\s|bound(?!$)/g, '')\n  options = options || {}\n  // default to true\n  var multiArgs = options.multiArgs !== undefined ? options.multiArgs : true\n  multiArgs = 'var multiArgs = ' + JSON.stringify(multiArgs) + '\\n'\n\n  var withCallback = options.withCallback ?\n    'var lastType = typeof arguments[len - 1]\\n'\n    + 'if (lastType === \"function\") return $$__fn__$$.apply(self, arguments)\\n'\n   : ''\n\n  return '(function ' + name + '() {\\n'\n    + 'var self = this\\n'\n    + 'var len = arguments.length\\n'\n    + multiArgs\n    + withCallback\n    + 'var args = new Array(len + 1)\\n'\n    + 'for (var i = 0; i < len; ++i) args[i] = arguments[i]\\n'\n    + 'var lastIndex = i\\n'\n    + 'return new Promise(function (resolve, reject) {\\n'\n      + 'args[lastIndex] = createCallback(resolve, reject, multiArgs)\\n'\n      + '$$__fn__$$.apply(self, args)\\n'\n    + '})\\n'\n  + '})'\n}\n"]}