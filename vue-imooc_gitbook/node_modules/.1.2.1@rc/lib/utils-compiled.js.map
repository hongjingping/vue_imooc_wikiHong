{"version":3,"sources":["../../rc/lib/utils.js"],"names":[],"mappings":"AAAA;;AACA,IAAI,KAAO,QAAQ,IAAR,CAAX;AACA,IAAI,MAAO,QAAQ,KAAR,CAAX;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,oBAAoB,QAAQ,qBAAR,CAAxB;;AAEA,IAAI,QAAQ,QAAQ,KAAR,GAAgB,UAAU,OAAV,EAAmB;;AAE7C;AACA;AACA;AACA;;AAEA,MAAG,QAAQ,IAAR,CAAa,OAAb,CAAH,EACE,OAAO,KAAK,KAAL,CAAW,kBAAkB,OAAlB,CAAX,CAAP;AACF,SAAO,IAAI,KAAJ,CAAU,OAAV,CAAP;AAED,CAXD;;AAaA,IAAI,OAAO,QAAQ,IAAR,GAAe,YAAY;AACpC,MAAI,OAAO,GAAG,KAAH,CAAS,IAAT,CAAc,SAAd,EAAyB,MAAzB,CAAgC,UAAU,GAAV,EAAe;AAAE,WAAO,OAAO,IAAd;AAAoB,GAArE,CAAX;;AAEA;AACA,OAAI,IAAI,CAAR,IAAa,IAAb,EACE,IAAG,aAAa,OAAO,KAAK,CAAL,CAAvB,EACE;;AAEJ,MAAI,OAAO,KAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,EAAsB,IAAtB,CAAX;AACA,MAAI,OAAJ;AACA,MAAI;AACF,WAAO,GAAG,YAAH,CAAgB,IAAhB,EAAqB,OAArB,CAAP;AACD,GAFD,CAEE,OAAO,GAAP,EAAY;AACZ;AACD;AACF,CAfD;;AAiBA,IAAI,OAAO,QAAQ,IAAR,GAAe,YAAY;AACpC,MAAI,UAAU,KAAK,KAAL,CAAW,IAAX,EAAiB,SAAjB,CAAd;AACA,SAAO,UAAU,MAAM,OAAN,CAAV,GAA2B,IAAlC;AACD,CAHD;;AAKA,IAAI,MAAM,QAAQ,GAAR,GAAc,UAAU,MAAV,EAAkB,GAAlB,EAAuB;AAC7C,QAAM,OAAO,QAAQ,GAArB;AACA,MAAI,MAAM,EAAV;AACA,MAAI,IAAI,OAAO,MAAf;AACA,OAAI,IAAI,CAAR,IAAa,GAAb,EAAkB;AAChB,QAAG,EAAE,WAAF,GAAgB,OAAhB,CAAwB,OAAO,WAAP,EAAxB,MAAkD,CAArD,EAAwD;;AAEtD,UAAI,UAAU,EAAE,SAAF,CAAY,CAAZ,EAAe,KAAf,CAAqB,IAArB,CAAd;;AAEA;AACA,UAAI,iBAAJ;AACA,aAAO,CAAC,oBAAkB,QAAQ,OAAR,CAAgB,EAAhB,CAAnB,IAA0C,CAAC,CAAlD,EAAqD;AACnD,gBAAQ,MAAR,CAAe,iBAAf,EAAkC,CAAlC;AACD;;AAED,UAAI,SAAS,GAAb;AACA,cAAQ,OAAR,CAAgB,SAAS,YAAT,CAAsB,OAAtB,EAA8B,CAA9B,EAAgC;;AAE9C;AACA;AACA,YAAI,CAAC,OAAD,IAAY,OAAO,MAAP,KAAkB,QAAlC,EACE;;AAEF;AACA;AACA;AACA,YAAI,MAAM,QAAQ,MAAR,GAAe,CAAzB,EACE,OAAO,OAAP,IAAkB,IAAI,CAAJ,CAAlB;;AAGF;AACA,YAAI,OAAO,OAAP,MAAoB,SAAxB,EACE,OAAO,OAAP,IAAkB,EAAlB;;AAEF;AACA,iBAAS,OAAO,OAAP,CAAT;AAED,OArBD;AAuBD;AAEF;;AAED,SAAO,GAAP;AACD,CA5CD;;AA8CA,IAAI,OAAO,QAAQ,IAAR,GAAe,YAAY;AACpC,MAAI,MAAM,KAAK,IAAL,CAAU,KAAV,CAAgB,IAAhB,EAAsB,GAAG,KAAH,CAAS,IAAT,CAAc,SAAd,CAAtB,CAAV;;AAEA,WAAS,IAAT,CAAc,KAAd,EAAqB,GAArB,EAA0B;AACxB,QAAI,OAAO,KAAK,IAAL,CAAU,KAAV,EAAiB,GAAjB,CAAX;AACA,QAAI;AACF,SAAG,QAAH,CAAY,IAAZ;AACA,aAAO,IAAP;AACD,KAHD,CAGE,OAAO,GAAP,EAAY;AACZ,UAAG,KAAK,OAAL,CAAa,KAAb,MAAwB,KAA3B,EAAkC;AAChC,eAAO,KAAK,KAAK,OAAL,CAAa,KAAb,CAAL,EAA0B,GAA1B,CAAP;AACH;AACF;AACD,SAAO,KAAK,QAAQ,GAAR,EAAL,EAAoB,GAApB,CAAP;AACD,CAdD","file":"utils-compiled.js","sourcesContent":["'use strict';\nvar fs   = require('fs')\nvar ini  = require('ini')\nvar path = require('path')\nvar stripJsonComments = require('strip-json-comments')\n\nvar parse = exports.parse = function (content) {\n\n  //if it ends in .json or starts with { then it must be json.\n  //must be done this way, because ini accepts everything.\n  //can't just try and parse it and let it throw if it's not ini.\n  //everything is ini. even json with a syntax error.\n\n  if(/^\\s*{/.test(content))\n    return JSON.parse(stripJsonComments(content))\n  return ini.parse(content)\n\n}\n\nvar file = exports.file = function () {\n  var args = [].slice.call(arguments).filter(function (arg) { return arg != null })\n\n  //path.join breaks if it's a not a string, so just skip this.\n  for(var i in args)\n    if('string' !== typeof args[i])\n      return\n\n  var file = path.join.apply(null, args)\n  var content\n  try {\n    return fs.readFileSync(file,'utf-8')\n  } catch (err) {\n    return\n  }\n}\n\nvar json = exports.json = function () {\n  var content = file.apply(null, arguments)\n  return content ? parse(content) : null\n}\n\nvar env = exports.env = function (prefix, env) {\n  env = env || process.env\n  var obj = {}\n  var l = prefix.length\n  for(var k in env) {\n    if(k.toLowerCase().indexOf(prefix.toLowerCase()) === 0) {\n\n      var keypath = k.substring(l).split('__')\n\n      // Trim empty strings from keypath array\n      var _emptyStringIndex\n      while ((_emptyStringIndex=keypath.indexOf('')) > -1) {\n        keypath.splice(_emptyStringIndex, 1)\n      }\n\n      var cursor = obj\n      keypath.forEach(function _buildSubObj(_subkey,i){\n\n        // (check for _subkey first so we ignore empty strings)\n        // (check for cursor to avoid assignment to primitive objects)\n        if (!_subkey || typeof cursor !== 'object')\n          return\n\n        // If this is the last key, just stuff the value in there\n        // Assigns actual value from env variable to final key\n        // (unless it's just an empty string- in that case use the last valid key)\n        if (i === keypath.length-1)\n          cursor[_subkey] = env[k]\n\n\n        // Build sub-object if nothing already exists at the keypath\n        if (cursor[_subkey] === undefined)\n          cursor[_subkey] = {}\n\n        // Increment cursor used to track the object at the current depth\n        cursor = cursor[_subkey]\n\n      })\n\n    }\n\n  }\n\n  return obj\n}\n\nvar find = exports.find = function () {\n  var rel = path.join.apply(null, [].slice.call(arguments))\n\n  function find(start, rel) {\n    var file = path.join(start, rel)\n    try {\n      fs.statSync(file)\n      return file\n    } catch (err) {\n      if(path.dirname(start) !== start) // root\n        return find(path.dirname(start), rel)\n    }\n  }\n  return find(process.cwd(), rel)\n}\n\n\n"]}