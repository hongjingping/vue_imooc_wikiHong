{"version":3,"sources":["promise_array-compiled.js"],"names":[],"mappings":"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","file":"promise_array-compiled-compiled.js","sourcesContent":["\"use strict\";\n\nmodule.exports = function (Promise, INTERNAL, tryConvertToPromise, apiRejection, Proxyable) {\n    var util = require(\"./util\");\n    var isArray = util.isArray;\n\n    function toResolutionValue(val) {\n        switch (val) {\n            case -2:\n                return [];\n            case -3:\n                return {};\n            case -6:\n                return new Map();\n        }\n    }\n\n    function PromiseArray(values) {\n        var promise = this._promise = new Promise(INTERNAL);\n        if (values instanceof Promise) {\n            promise._propagateFrom(values, 3);\n        }\n        promise._setOnCancel(this);\n        this._values = values;\n        this._length = 0;\n        this._totalResolved = 0;\n        this._init(undefined, -2);\n    }\n    util.inherits(PromiseArray, Proxyable);\n\n    PromiseArray.prototype.length = function () {\n        return this._length;\n    };\n\n    PromiseArray.prototype.promise = function () {\n        return this._promise;\n    };\n\n    PromiseArray.prototype._init = function init(_, resolveValueIfEmpty) {\n        var values = tryConvertToPromise(this._values, this._promise);\n        if (values instanceof Promise) {\n            values = values._target();\n            var bitField = values._bitField;\n            ;\n            this._values = values;\n\n            if ((bitField & 50397184) === 0) {\n                this._promise._setAsyncGuaranteed();\n                return values._then(init, this._reject, undefined, this, resolveValueIfEmpty);\n            } else if ((bitField & 33554432) !== 0) {\n                values = values._value();\n            } else if ((bitField & 16777216) !== 0) {\n                return this._reject(values._reason());\n            } else {\n                return this._cancel();\n            }\n        }\n        values = util.asArray(values);\n        if (values === null) {\n            var err = apiRejection(\"expecting an array or an iterable object but got \" + util.classString(values)).reason();\n            this._promise._rejectCallback(err, false);\n            return;\n        }\n\n        if (values.length === 0) {\n            if (resolveValueIfEmpty === -5) {\n                this._resolveEmptyArray();\n            } else {\n                this._resolve(toResolutionValue(resolveValueIfEmpty));\n            }\n            return;\n        }\n        this._iterate(values);\n    };\n\n    PromiseArray.prototype._iterate = function (values) {\n        var len = this.getActualLength(values.length);\n        this._length = len;\n        this._values = this.shouldCopyValues() ? new Array(len) : this._values;\n        var result = this._promise;\n        var isResolved = false;\n        var bitField = null;\n        for (var i = 0; i < len; ++i) {\n            var maybePromise = tryConvertToPromise(values[i], result);\n\n            if (maybePromise instanceof Promise) {\n                maybePromise = maybePromise._target();\n                bitField = maybePromise._bitField;\n            } else {\n                bitField = null;\n            }\n\n            if (isResolved) {\n                if (bitField !== null) {\n                    maybePromise.suppressUnhandledRejections();\n                }\n            } else if (bitField !== null) {\n                if ((bitField & 50397184) === 0) {\n                    maybePromise._proxy(this, i);\n                    this._values[i] = maybePromise;\n                } else if ((bitField & 33554432) !== 0) {\n                    isResolved = this._promiseFulfilled(maybePromise._value(), i);\n                } else if ((bitField & 16777216) !== 0) {\n                    isResolved = this._promiseRejected(maybePromise._reason(), i);\n                } else {\n                    isResolved = this._promiseCancelled(i);\n                }\n            } else {\n                isResolved = this._promiseFulfilled(maybePromise, i);\n            }\n        }\n        if (!isResolved) result._setAsyncGuaranteed();\n    };\n\n    PromiseArray.prototype._isResolved = function () {\n        return this._values === null;\n    };\n\n    PromiseArray.prototype._resolve = function (value) {\n        this._values = null;\n        this._promise._fulfill(value);\n    };\n\n    PromiseArray.prototype._cancel = function () {\n        if (this._isResolved() || !this._promise._isCancellable()) return;\n        this._values = null;\n        this._promise._cancel();\n    };\n\n    PromiseArray.prototype._reject = function (reason) {\n        this._values = null;\n        this._promise._rejectCallback(reason, false);\n    };\n\n    PromiseArray.prototype._promiseFulfilled = function (value, index) {\n        this._values[index] = value;\n        var totalResolved = ++this._totalResolved;\n        if (totalResolved >= this._length) {\n            this._resolve(this._values);\n            return true;\n        }\n        return false;\n    };\n\n    PromiseArray.prototype._promiseCancelled = function () {\n        this._cancel();\n        return true;\n    };\n\n    PromiseArray.prototype._promiseRejected = function (reason) {\n        this._totalResolved++;\n        this._reject(reason);\n        return true;\n    };\n\n    PromiseArray.prototype._resultCancelled = function () {\n        if (this._isResolved()) return;\n        var values = this._values;\n        this._cancel();\n        if (values instanceof Promise) {\n            values.cancel();\n        } else {\n            for (var i = 0; i < values.length; ++i) {\n                if (values[i] instanceof Promise) {\n                    values[i].cancel();\n                }\n            }\n        }\n    };\n\n    PromiseArray.prototype.shouldCopyValues = function () {\n        return true;\n    };\n\n    PromiseArray.prototype.getActualLength = function (len) {\n        return len;\n    };\n\n    return PromiseArray;\n};\n\n//# sourceMappingURL=promise_array-compiled.js.map"]}