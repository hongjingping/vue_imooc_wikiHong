{"version":3,"sources":["join-compiled.js"],"names":[],"mappings":"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","file":"join-compiled-compiled.js","sourcesContent":["\"use strict\";\n\nmodule.exports = function (Promise, PromiseArray, tryConvertToPromise, INTERNAL, async, getDomain) {\n    var util = require(\"./util\");\n    var canEvaluate = util.canEvaluate;\n    var tryCatch = util.tryCatch;\n    var errorObj = util.errorObj;\n    var reject;\n\n    if (!false) {\n        if (canEvaluate) {\n            var thenCallback = function (i) {\n                return new Function(\"value\", \"holder\", \"                             \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = value;                                           \\n\\\n            holder.checkFulfillment(this);                                   \\n\\\n            \".replace(/Index/g, i));\n            };\n\n            var promiseSetter = function (i) {\n                return new Function(\"promise\", \"holder\", \"                           \\n\\\n            'use strict';                                                    \\n\\\n            holder.pIndex = promise;                                         \\n\\\n            \".replace(/Index/g, i));\n            };\n\n            var generateHolderClass = function (total) {\n                var props = new Array(total);\n                for (var i = 0; i < props.length; ++i) {\n                    props[i] = \"this.p\" + (i + 1);\n                }\n                var assignment = props.join(\" = \") + \" = null;\";\n                var cancellationCode = \"var promise;\\n\" + props.map(function (prop) {\n                    return \"                                                         \\n\\\n                promise = \" + prop + \";                                      \\n\\\n                if (promise instanceof Promise) {                            \\n\\\n                    promise.cancel();                                        \\n\\\n                }                                                            \\n\\\n            \";\n                }).join(\"\\n\");\n                var passedArguments = props.join(\", \");\n                var name = \"Holder$\" + total;\n\n                var code = \"return function(tryCatch, errorObj, Promise, async) {    \\n\\\n            'use strict';                                                    \\n\\\n            function [TheName](fn) {                                         \\n\\\n                [TheProperties]                                              \\n\\\n                this.fn = fn;                                                \\n\\\n                this.asyncNeeded = true;                                     \\n\\\n                this.now = 0;                                                \\n\\\n            }                                                                \\n\\\n                                                                             \\n\\\n            [TheName].prototype._callFunction = function(promise) {          \\n\\\n                promise._pushContext();                                      \\n\\\n                var ret = tryCatch(this.fn)([ThePassedArguments]);           \\n\\\n                promise._popContext();                                       \\n\\\n                if (ret === errorObj) {                                      \\n\\\n                    promise._rejectCallback(ret.e, false);                   \\n\\\n                } else {                                                     \\n\\\n                    promise._resolveCallback(ret);                           \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype.checkFulfillment = function(promise) {       \\n\\\n                var now = ++this.now;                                        \\n\\\n                if (now === [TheTotal]) {                                    \\n\\\n                    if (this.asyncNeeded) {                                  \\n\\\n                        async.invoke(this._callFunction, this, promise);     \\n\\\n                    } else {                                                 \\n\\\n                        this._callFunction(promise);                         \\n\\\n                    }                                                        \\n\\\n                                                                             \\n\\\n                }                                                            \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            [TheName].prototype._resultCancelled = function() {              \\n\\\n                [CancellationCode]                                           \\n\\\n            };                                                               \\n\\\n                                                                             \\n\\\n            return [TheName];                                                \\n\\\n        }(tryCatch, errorObj, Promise, async);                               \\n\\\n        \";\n\n                code = code.replace(/\\[TheName\\]/g, name).replace(/\\[TheTotal\\]/g, total).replace(/\\[ThePassedArguments\\]/g, passedArguments).replace(/\\[TheProperties\\]/g, assignment).replace(/\\[CancellationCode\\]/g, cancellationCode);\n\n                return new Function(\"tryCatch\", \"errorObj\", \"Promise\", \"async\", code)(tryCatch, errorObj, Promise, async);\n            };\n\n            var holderClasses = [];\n            var thenCallbacks = [];\n            var promiseSetters = [];\n\n            for (var i = 0; i < 8; ++i) {\n                holderClasses.push(generateHolderClass(i + 1));\n                thenCallbacks.push(thenCallback(i + 1));\n                promiseSetters.push(promiseSetter(i + 1));\n            }\n\n            reject = function (reason) {\n                this._reject(reason);\n            };\n        }\n    }\n\n    Promise.join = function () {\n        var last = arguments.length - 1;\n        var fn;\n        if (last > 0 && typeof arguments[last] === \"function\") {\n            fn = arguments[last];\n            if (!false) {\n                if (last <= 8 && canEvaluate) {\n                    var ret = new Promise(INTERNAL);\n                    ret._captureStackTrace();\n                    var HolderClass = holderClasses[last - 1];\n                    var holder = new HolderClass(fn);\n                    var callbacks = thenCallbacks;\n\n                    for (var i = 0; i < last; ++i) {\n                        var maybePromise = tryConvertToPromise(arguments[i], ret);\n                        if (maybePromise instanceof Promise) {\n                            maybePromise = maybePromise._target();\n                            var bitField = maybePromise._bitField;\n                            ;\n                            if ((bitField & 50397184) === 0) {\n                                maybePromise._then(callbacks[i], reject, undefined, ret, holder);\n                                promiseSetters[i](maybePromise, holder);\n                                holder.asyncNeeded = false;\n                            } else if ((bitField & 33554432) !== 0) {\n                                callbacks[i].call(ret, maybePromise._value(), holder);\n                            } else if ((bitField & 16777216) !== 0) {\n                                ret._reject(maybePromise._reason());\n                            } else {\n                                ret._cancel();\n                            }\n                        } else {\n                            callbacks[i].call(ret, maybePromise, holder);\n                        }\n                    }\n\n                    if (!ret._isFateSealed()) {\n                        if (holder.asyncNeeded) {\n                            var domain = getDomain();\n                            if (domain !== null) {\n                                holder.fn = util.domainBind(domain, holder.fn);\n                            }\n                        }\n                        ret._setAsyncGuaranteed();\n                        ret._setOnCancel(holder);\n                    }\n                    return ret;\n                }\n            }\n        }\n        var $_len = arguments.length;var args = new Array($_len);for (var $_i = 0; $_i < $_len; ++$_i) {\n            args[$_i] = arguments[$_i];\n        };\n        if (fn) args.pop();\n        var ret = new PromiseArray(args).promise();\n        return fn !== undefined ? ret.spread(fn) : ret;\n    };\n};\n\n//# sourceMappingURL=join-compiled.js.map"]}