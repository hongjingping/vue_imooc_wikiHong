{"version":3,"sources":["map-compiled.js"],"names":[],"mappings":"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","file":"map-compiled-compiled.js","sourcesContent":["\"use strict\";\n\nmodule.exports = function (Promise, PromiseArray, apiRejection, tryConvertToPromise, INTERNAL, debug) {\n    var getDomain = Promise._getDomain;\n    var util = require(\"./util\");\n    var tryCatch = util.tryCatch;\n    var errorObj = util.errorObj;\n    var async = Promise._async;\n\n    function MappingPromiseArray(promises, fn, limit, _filter) {\n        this.constructor$(promises);\n        this._promise._captureStackTrace();\n        var domain = getDomain();\n        this._callback = domain === null ? fn : util.domainBind(domain, fn);\n        this._preservedValues = _filter === INTERNAL ? new Array(this.length()) : null;\n        this._limit = limit;\n        this._inFlight = 0;\n        this._queue = [];\n        async.invoke(this._asyncInit, this, undefined);\n    }\n    util.inherits(MappingPromiseArray, PromiseArray);\n\n    MappingPromiseArray.prototype._asyncInit = function () {\n        this._init$(undefined, -2);\n    };\n\n    MappingPromiseArray.prototype._init = function () {};\n\n    MappingPromiseArray.prototype._promiseFulfilled = function (value, index) {\n        var values = this._values;\n        var length = this.length();\n        var preservedValues = this._preservedValues;\n        var limit = this._limit;\n\n        if (index < 0) {\n            index = index * -1 - 1;\n            values[index] = value;\n            if (limit >= 1) {\n                this._inFlight--;\n                this._drainQueue();\n                if (this._isResolved()) return true;\n            }\n        } else {\n            if (limit >= 1 && this._inFlight >= limit) {\n                values[index] = value;\n                this._queue.push(index);\n                return false;\n            }\n            if (preservedValues !== null) preservedValues[index] = value;\n\n            var promise = this._promise;\n            var callback = this._callback;\n            var receiver = promise._boundValue();\n            promise._pushContext();\n            var ret = tryCatch(callback).call(receiver, value, index, length);\n            var promiseCreated = promise._popContext();\n            debug.checkForgottenReturns(ret, promiseCreated, preservedValues !== null ? \"Promise.filter\" : \"Promise.map\", promise);\n            if (ret === errorObj) {\n                this._reject(ret.e);\n                return true;\n            }\n\n            var maybePromise = tryConvertToPromise(ret, this._promise);\n            if (maybePromise instanceof Promise) {\n                maybePromise = maybePromise._target();\n                var bitField = maybePromise._bitField;\n                ;\n                if ((bitField & 50397184) === 0) {\n                    if (limit >= 1) this._inFlight++;\n                    values[index] = maybePromise;\n                    maybePromise._proxy(this, (index + 1) * -1);\n                    return false;\n                } else if ((bitField & 33554432) !== 0) {\n                    ret = maybePromise._value();\n                } else if ((bitField & 16777216) !== 0) {\n                    this._reject(maybePromise._reason());\n                    return true;\n                } else {\n                    this._cancel();\n                    return true;\n                }\n            }\n            values[index] = ret;\n        }\n        var totalResolved = ++this._totalResolved;\n        if (totalResolved >= length) {\n            if (preservedValues !== null) {\n                this._filter(values, preservedValues);\n            } else {\n                this._resolve(values);\n            }\n            return true;\n        }\n        return false;\n    };\n\n    MappingPromiseArray.prototype._drainQueue = function () {\n        var queue = this._queue;\n        var limit = this._limit;\n        var values = this._values;\n        while (queue.length > 0 && this._inFlight < limit) {\n            if (this._isResolved()) return;\n            var index = queue.pop();\n            this._promiseFulfilled(values[index], index);\n        }\n    };\n\n    MappingPromiseArray.prototype._filter = function (booleans, values) {\n        var len = values.length;\n        var ret = new Array(len);\n        var j = 0;\n        for (var i = 0; i < len; ++i) {\n            if (booleans[i]) ret[j++] = values[i];\n        }\n        ret.length = j;\n        this._resolve(ret);\n    };\n\n    MappingPromiseArray.prototype.preservedValues = function () {\n        return this._preservedValues;\n    };\n\n    function map(promises, fn, options, _filter) {\n        if (typeof fn !== \"function\") {\n            return apiRejection(\"expecting a function but got \" + util.classString(fn));\n        }\n\n        var limit = 0;\n        if (options !== undefined) {\n            if (typeof options === \"object\" && options !== null) {\n                if (typeof options.concurrency !== \"number\") {\n                    return Promise.reject(new TypeError(\"'concurrency' must be a number but it is \" + util.classString(options.concurrency)));\n                }\n                limit = options.concurrency;\n            } else {\n                return Promise.reject(new TypeError(\"options argument must be an object but it is \" + util.classString(options)));\n            }\n        }\n        limit = typeof limit === \"number\" && isFinite(limit) && limit >= 1 ? limit : 0;\n        return new MappingPromiseArray(promises, fn, limit, _filter).promise();\n    }\n\n    Promise.prototype.map = function (fn, options) {\n        return map(this, fn, options, null);\n    };\n\n    Promise.map = function (promises, fn, options, _filter) {\n        return map(promises, fn, options, _filter);\n    };\n};\n\n//# sourceMappingURL=map-compiled.js.map"]}