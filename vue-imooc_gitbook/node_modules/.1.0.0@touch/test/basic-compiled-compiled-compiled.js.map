{"version":3,"sources":["../../touch/test/basic-compiled-compiled.js"],"names":[],"mappings":"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","file":"basic-compiled-compiled-compiled.js","sourcesContent":["var fs = require(\"fs\");\nvar touch = require(\"../touch.js\");\nvar t = require('tap');\n\nfunction _(fn) {\n  return function (er) {\n    if (er) throw er;\n    fn();\n  };\n}\n\nvar files = ['sync', 'sync-ref', 'async', 'async-ref'];\n\nfiles.forEach(function (f) {\n  try {\n    fs.unlinkSync(f);\n  } catch (e) {}\n});\n\nvar now = Math.floor(Date.now() / 1000) * 1000;\nvar then = now - 1000000000; // now - 1Msec\n\nt.test('set both to now', function (t) {\n  touch.sync(\"sync\");\n  touch(\"async\", _(function () {\n    var astat = fs.statSync(\"async\");\n    var sstat = fs.statSync(\"sync\");\n    var asa = astat.atime.getTime();\n    var ssa = sstat.atime.getTime();\n    var asm = astat.mtime.getTime();\n    var ssm = sstat.mtime.getTime();\n\n    t.equal(asm, asa);\n    t.equal(ssm, ssa);\n    t.equal(ssa, now);\n    t.equal(asa, now);\n\n    // ctime should always be now-ish\n    t.ok(Math.abs(Date.now() - sstat.ctime.getTime()) < 1000);\n    t.ok(Math.abs(Date.now() - astat.ctime.getTime()) < 1000);\n    t.end();\n  }));\n});\n\nt.test('set both to now, using futimes', function (t) {\n  function runTest(closeAfter) {\n    t.test('closeAfter=' + closeAfter, function (t) {\n      var sfd = fs.openSync('sync', 'w');\n\n      if (closeAfter) {\n        touch.ftouchSync(sfd, { closeAfter: true });\n      } else {\n        touch.ftouchSync(sfd);\n        fs.closeSync(sfd);\n      }\n\n      var afd = fs.openSync('async', 'w');\n      t.equal(afd, sfd);\n\n      var then = _(function () {\n        if (!closeAfter) {\n          fs.closeSync(afd);\n        }\n\n        var astat = fs.statSync(\"async\");\n        var sstat = fs.statSync(\"sync\");\n        var asa = astat.atime.getTime();\n        var ssa = sstat.atime.getTime();\n        var asm = astat.mtime.getTime();\n        var ssm = sstat.mtime.getTime();\n\n        t.equal(asm, asa);\n        t.equal(ssm, ssa);\n        t.equal(ssa, now);\n        t.equal(asa, now);\n\n        // ctime should always be now-ish\n        t.ok(Math.abs(Date.now() - sstat.ctime.getTime()) < 1000);\n        t.ok(Math.abs(Date.now() - astat.ctime.getTime()) < 1000);\n        t.end();\n      });\n\n      if (closeAfter) {\n        touch.ftouch(afd, { closeAfter: true }, then);\n      } else {\n        touch.ftouch(afd, then);\n      }\n    });\n  }\n\n  runTest(true);\n  runTest(false);\n  t.end();\n});\n\nt.test('set both to now - 1Msec', function (t) {\n  // also use force, just for funsies\n  touch.sync(\"sync\", { time: then, force: true });\n  touch(\"async\", { time: then, force: true }, _(function () {\n    var astat = fs.statSync(\"async\");\n    var sstat = fs.statSync(\"sync\");\n    var asa = astat.atime.getTime();\n    var ssa = sstat.atime.getTime();\n    var asm = astat.mtime.getTime();\n    var ssm = sstat.mtime.getTime();\n\n    t.notEqual(asm, now);\n    t.equal(asa, asm);\n\n    t.notEqual(ssm, now);\n    t.equal(ssa, ssm);\n\n    t.equal(ssa, then);\n    t.equal(asa, then);\n\n    t.ok(Math.abs(Date.now() - sstat.ctime.getTime()) < 1000);\n    t.ok(Math.abs(Date.now() - astat.ctime.getTime()) < 1000);\n    t.end();\n  }));\n});\n\nt.test('set mtime to now', function (t) {\n  touch.sync(\"sync\", { time: now, mtime: true });\n  touch(\"async\", { time: now, mtime: true }, _(function () {\n    var astat = fs.statSync(\"async\");\n    var sstat = fs.statSync(\"sync\");\n    var asa = astat.atime.getTime();\n    var ssa = sstat.atime.getTime();\n    var asm = astat.mtime.getTime();\n    var ssm = sstat.mtime.getTime();\n\n    t.notEqual(asa, asm);\n    t.notEqual(ssa, ssm);\n\n    t.equal(ssa, then);\n    t.equal(asa, then);\n\n    t.equal(ssm, now);\n    t.equal(asm, now);\n\n    t.ok(Math.abs(Date.now() - sstat.ctime.getTime()) < 1000);\n    t.ok(Math.abs(Date.now() - astat.ctime.getTime()) < 1000);\n    t.end();\n  }));\n});\n\nt.test('set atime to now', function (t) {\n  touch.sync(\"sync\", { time: now, atime: true });\n  touch(\"async\", { time: now, atime: true }, _(function () {\n    var astat = fs.statSync(\"async\");\n    var sstat = fs.statSync(\"sync\");\n    var asa = astat.atime.getTime();\n    var ssa = sstat.atime.getTime();\n    var asm = astat.mtime.getTime();\n    var ssm = sstat.mtime.getTime();\n\n    t.equal(asm, now);\n    t.equal(ssm, now);\n\n    t.equal(asa, now);\n    t.equal(ssa, now);\n\n    t.ok(Math.abs(Date.now() - sstat.ctime.getTime()) < 1000);\n    t.ok(Math.abs(Date.now() - astat.ctime.getTime()) < 1000);\n    t.end();\n  }));\n});\n\nt.test('nocreate should throw on ENOENT', function (t) {\n  t.throws(function () {\n    touch.sync('sync-noent', { nocreate: true });\n  });\n  touch('async-noent', { nocreate: true }, function (er) {\n    t.isa(er, Error);\n    t.end();\n  });\n});\n\nt.test('use one file as ref for another', function (t) {\n  touch.sync('sync-ref', { ref: 'sync' });\n  touch('async-ref', { ref: 'async' }, _(function () {\n    var astat = fs.statSync(\"async\");\n    var sstat = fs.statSync(\"sync\");\n    var arstat = fs.statSync('async-ref');\n    var srstat = fs.statSync('sync-ref');\n\n    var asa = astat.atime.getTime();\n    var ssa = sstat.atime.getTime();\n    var arsa = arstat.atime.getTime();\n    var srsa = srstat.atime.getTime();\n\n    var asm = astat.mtime.getTime();\n    var ssm = sstat.mtime.getTime();\n    var arsm = arstat.mtime.getTime();\n    var srsm = srstat.mtime.getTime();\n\n    var arsc = arstat.ctime.getTime();\n    var srsc = srstat.ctime.getTime();\n\n    t.equal(asm, arsm);\n    t.equal(ssm, srsm);\n\n    t.equal(asa, arsa);\n    t.equal(ssa, srsa);\n\n    t.ok(Math.abs(Date.now() - srsc) < 1000);\n    t.ok(Math.abs(Date.now() - arsc) < 1000);\n    t.end();\n  }));\n});\n\nt.test('cleanup', function (t) {\n  files.forEach(function (f) {\n    t.doesNotThrow('rm ' + f, function () {\n      fs.unlinkSync(f);\n    });\n  });\n  t.end();\n});\n\n//# sourceMappingURL=basic-compiled.js.map\n\n//# sourceMappingURL=basic-compiled-compiled.js.map"]}